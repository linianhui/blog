<link href="//cdn.bootcdn.net/ajax/libs/element-ui/1.4.13/theme-default/index.css" rel="stylesheet">
<style>
  .article-content table {
    margin-top: unset;
    border: unset;
    padding: unset;
    border-collapse: unset;
  }

  .cell {
    padding: 0 !important;
  }
</style>
<div id="app">
  <div style="margin-bottom: 10px;">
    <el-input v-model="amount" style="width: unset;" placeholder="税前月工资"></el-input>
    <el-select v-model="insuranceValue">
      <el-option v-for="item in insurance" :key="item" :label="item" :value="item">
      </el-option>
    </el-select>
    <el-select v-model="rateValue">
      <el-option v-for="item in rate" :key="item" :label="item" :value="item">
      </el-option>
    </el-select>
  </div>

  <div>
    年收入合计：税前收入{{ salarys.summary.baseYTD }} -
    税后收入{{ salarys.summary.totalActualYTD }}(
    税后{{ salarys.summary.actualYTD }} +
    公积金{{ salarys.summary.公积金YTD }} +
    医疗{{ salarys.summary.医疗YTD }} ) =
    差额{{ salarys.summary.diffYTD }}
  </div>
  <el-table :data="salarys.items" :default-sort="defaultSort">
    <el-table-column prop="month" label="月份" align="right" width="70" :sortable="true"></el-table-column>
    <el-table-column prop="baseYTD" label="税前YTD" align="right"></el-table-column>
    <el-table-column prop="exemptedYTD" label="免征额YTD" align="right" width="85"></el-table-column>
    <el-table-column prop="insurancesPersonalYTD" label="社保个人YTD" align="right" width="100"></el-table-column>
    <el-table-column prop="taxableYTD" label="税基YTD" align="right"></el-table-column>
    <el-table-column prop="rate.rate" label="税率" align="right" width="45"></el-table-column>
    <el-table-column prop="tax" label="个税" align="right"></el-table-column>
    <el-table-column prop="taxYTD" label="个税YTD" align="right"></el-table-column>
    <el-table-column prop="actual" label="税后" align="right"></el-table-column>
    <el-table-column prop="actualYTD" label="税后YTD" align="right"></el-table-column>
  </el-table>
</div>
<script src="//cdn.bootcdn.net/ajax/libs/vue/2.6.12/vue.min.js"></script>
<script src="//cdn.bootcdn.net/ajax/libs/element-ui/1.4.13/index.js"></script>
<script src="config.js"></script>
<script src="calculator.js"></script>
<script type="text/javascript">
  const configRateKeyArray = Object.keys(config.rates);
  const configInsuranceKeyArray = Object.keys(config.insurances);
  new Vue({
    el: "#app",
    data: function () {
      return {
        amount: 5000,
        rate: configRateKeyArray,
        rateValue: configRateKeyArray[0],
        insurance: configInsuranceKeyArray,
        insuranceValue: configInsuranceKeyArray[0],
        defaultSort: {
          prop: 'month',
          order: 'descending'
        }
      }
    },

    computed: {
      currentRate() {
        return config.rates[this.rateValue];
      },
      currentInsurance() {
        return config.insurances[this.insuranceValue];
      },
      salarys() {
        var items = buildSalaryList(parseInt(this.amount, 10), this.insuranceValue, this.rateValue);
        calculateOneYear(items);
        items.shift();

        console.log(JSON.parse(JSON.stringify(items)));

        var summary = buildSummary(items);

        console.log(JSON.parse(JSON.stringify(summary)));

        return {
          items: items,
          summary: summary
        };
      }
    }
  })
</script>